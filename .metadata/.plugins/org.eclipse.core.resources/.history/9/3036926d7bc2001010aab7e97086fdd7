# ğŸš€ POSTMAN COLLECTION - GUÃA DE USO

**GraphQL DGS NeoBank Course - Chapter 01**

---

## ğŸ“¥ IMPORTAR EN POSTMAN

### Paso 1: Importar Collection

1. Abre Postman
2. Click en **Import** (esquina superior izquierda)
3. Arrastra el archivo `CHAPTER_01.postman_collection.json`
4. Click **Import**

### Paso 2: Importar Environment

1. Click en **Import** nuevamente
2. Arrastra el archivo `GraphQL-NeoBank-Course.postman_environment.json`
3. Click **Import**

### Paso 3: Activar Environment

1. En la esquina superior derecha, selecciona el dropdown de environments
2. Selecciona **GraphQL-DGS-NeoBank-Course**
3. âœ… Listo, todas las variables estÃ¡n configuradas

---

## ğŸ¯ ESTRUCTURA DE LA COLLECTION

```
CHAPTER 01: GraphQL Fundamentals
â”‚
â”œâ”€â”€ ğŸ“ Section 1.1 - REST vs GraphQL (7 tests)
â”‚   â”œâ”€â”€ 1.1.1 - REST: Overfetching
â”‚   â”œâ”€â”€ 1.1.2 - GraphQL: Only Names
â”‚   â”œâ”€â”€ 1.1.3a/b/c - REST: 3 Calls (Underfetching)
â”‚   â”œâ”€â”€ 1.1.4 - GraphQL: One Call
â”‚   â””â”€â”€ 1.1.5 - GraphQL: Single Endpoint
â”‚
â”œâ”€â”€ ğŸ“ Section 1.2 - Components & Base Language (9 tests)
â”‚   â”œâ”€â”€ 1.2.1 - Schema: Portfolio Type
â”‚   â”œâ”€â”€ 1.2.2a/b/c - Queries (simple, with args, search)
â”‚   â”œâ”€â”€ 1.2.3a/b/c - Mutations (create, add, remove)
â”‚   â”œâ”€â”€ 1.2.4 - Enum: AssetType
â”‚   â””â”€â”€ 1.2.5 - Resolvers
â”‚
â”œâ”€â”€ ğŸ“ Section 1.3 - Nested Queries & Variables (5 tests)
â”‚   â”œâ”€â”€ 1.3.1 - Nesting Level 1
â”‚   â”œâ”€â”€ 1.3.2 - Nesting Level 2
â”‚   â”œâ”€â”€ 1.3.3 - Query with Variables
â”‚   â”œâ”€â”€ 1.3.4 - Variable Validation
â”‚   â””â”€â”€ 1.3.5 - Multiple Relations
â”‚
â”œâ”€â”€ ğŸ“ Section 1.4 - Filters, Sorting & Pagination (7 tests)
â”‚   â”œâ”€â”€ 1.4.1 - Filter: Only STOCKS
â”‚   â”œâ”€â”€ 1.4.2 - Filter: Value > $5000
â”‚   â”œâ”€â”€ 1.4.3 - Sort: By Value DESC
â”‚   â”œâ”€â”€ 1.4.4 - Sort: By Profit
â”‚   â”œâ”€â”€ 1.4.5 - Pagination: First Page
â”‚   â”œâ”€â”€ 1.4.6 - Complex Query (all combined)
â”‚   â””â”€â”€ 1.4.7 - Reasonable Limit
â”‚
â””â”€â”€ ğŸ“ Section 1.5 - Typing, Nullability & Security (6 tests)
    â”œâ”€â”€ 1.5.1 - Type Validation: Float!
    â”œâ”€â”€ 1.5.2 - Non-Nullable Fields
    â”œâ”€â”€ 1.5.3 - Enum Validation
    â”œâ”€â”€ 1.5.4 - Introspection
    â”œâ”€â”€ 1.5.5 - Validation Error
    â””â”€â”€ 1.5.6 - Response Structure
```

**Total: 34 requests** (mapean 1:1 con los 34 tests del script bash)

---

## â–¶ï¸ CÃ“MO USAR

### OpciÃ³n 1: Ejecutar Request Individual

1. Click en cualquier request de la lista
2. Click en **Send**
3. Ver la respuesta en el panel inferior
4. Los **Tests** se ejecutan automÃ¡ticamente y muestran âœ… o âŒ

### OpciÃ³n 2: Ejecutar Toda una SecciÃ³n

1. Click derecho en una carpeta (ej: "Section 1.1")
2. Click en **Run folder**
3. Se abre el Collection Runner
4. Click **Run** para ejecutar todos los tests de esa secciÃ³n

### OpciÃ³n 3: Ejecutar TODOS los Tests (34)

1. Click derecho en la collection raÃ­z "CHAPTER 01"
2. Click en **Run collection**
3. Postman ejecuta los 34 tests en secuencia
4. Ver resultados: X/34 passed

---

## ğŸ”§ VARIABLES DE ENTORNO

La collection usa estas variables (ya configuradas):

| Variable | Valor | DescripciÃ³n |
|----------|-------|-------------|
| `BASE_URL` | `http://localhost:8080` | URL base del servidor |
| `GRAPHQL_ENDPOINT` | `{{BASE_URL}}/graphql` | Endpoint GraphQL |
| `REST_ENDPOINT` | `{{BASE_URL}}/api/rest` | Endpoint REST |
| `CREATED_PORTFOLIO_ID` | (vacÃ­o) | Se llena automÃ¡ticamente |

**âš ï¸ IMPORTANTE:** AsegÃºrate de tener el servidor corriendo:
```bash
mvn spring-boot:run
```

---

## ğŸ’¡ FEATURES ESPECIALES

### 1. Tests AutomÃ¡ticos

Cada request tiene **tests automÃ¡ticos** que validan:
- Status code 200
- Campos esperados en la respuesta
- Tipos de datos correctos
- Validaciones de negocio

**Ver tests:**
1. Click en un request
2. Ve a la pestaÃ±a **Tests**
3. VerÃ¡s el cÃ³digo JavaScript que valida la respuesta

### 2. Variables DinÃ¡micas

Algunos requests **guardan valores** para usar en otros:

**Ejemplo:**
- Request `1.2.3a - createPortfolio` crea un portfolio y guarda el ID
- Request `1.2.3b - addAsset` usa ese ID automÃ¡ticamente

**ImplementaciÃ³n:**
```javascript
// En el test del request 1.2.3a:
pm.environment.set("CREATED_PORTFOLIO_ID", jsonData.data.createPortfolio.portfolio.id);

// En el body del request 1.2.3b:
"portfolioId": "{{CREATED_PORTFOLIO_ID}}"
```

### 3. DocumentaciÃ³n Inline

Cada request tiene **descripciÃ³n** que explica:
- QuÃ© hace el request
- QuÃ© concepto enseÃ±a
- Por quÃ© es importante

**Ver documentaciÃ³n:**
- Click en un request
- Lee el panel derecho con la descripciÃ³n

---

## ğŸ“ USO EN CLASE

### Para el Instructor:

**Modo Demo (proyectado):**
1. Abre Postman en pantalla completa
2. Ejecuta requests uno por uno
3. Explica el concepto mientras se ejecuta
4. Muestra la respuesta y los tests pasando

**Modo ComparaciÃ³n:**
1. Ejecuta request REST (ej: 1.1.1)
2. Muestra la respuesta gigante (overfetching)
3. Ejecuta request GraphQL (ej: 1.1.2)
4. Muestra la respuesta pequeÃ±a
5. Contrasta visualmente

### Para el Alumno:

**Modo ExploraciÃ³n:**
1. Importa la collection
2. Ejecuta cada request
3. Modifica las queries (cambia campos)
4. Observa cÃ³mo cambian las respuestas
5. Experimenta con variables

**Modo PrÃ¡ctica:**
1. Crea tus propios requests
2. Usa la collection como referencia
3. Valida con los tests automÃ¡ticos

---

## ğŸ§ª EJECUTAR TODOS LOS TESTS

### Usando Collection Runner:

1. Click en la collection "CHAPTER 01"
2. Click en **Run**
3. Configura:
   - âœ… Save responses
   - âœ… Keep variable values
   - Iterations: 1
4. Click **Run CHAPTER 01**
5. Espera ~30 segundos
6. Ver resultados: **34/34 passed** âœ…

### Usando Newman (CLI):

```bash
# Instalar Newman
npm install -g newman

# Ejecutar collection
newman run CHAPTER_01.postman_collection.json \
  -e GraphQL-NeoBank-Course.postman_environment.json

# Con reporte HTML
newman run CHAPTER_01.postman_collection.json \
  -e GraphQL-NeoBank-Course.postman_environment.json \
  -r html
```

---

## ğŸ” TROUBLESHOOTING

### Problema: Tests fallan con "Error: connect ECONNREFUSED"

**SoluciÃ³n:** El servidor NO estÃ¡ corriendo.
```bash
# Inicia el servidor
cd CHAPTER_01/investment-portfolio-graphql
mvn spring-boot:run
```

### Problema: Variable CREATED_PORTFOLIO_ID estÃ¡ vacÃ­a

**SoluciÃ³n:** Ejecuta los requests en orden.
1. Primero ejecuta `1.2.3a - createPortfolio`
2. Luego ejecuta `1.2.3b - addAsset`

### Problema: "This request does not have any tests"

**SoluciÃ³n:** Revisa que importaste la collection correcta. Debe tener 34 requests con tests.

### Problema: Postman dice "Could not get any response"

**Soluciones:**
1. Verifica que el servidor estÃ¡ corriendo en puerto 8080
2. Prueba abrir `http://localhost:8080` en el navegador
3. Revisa que no haya firewall bloqueando

---

## ğŸ“Š COMPARACIÃ“N: Script .sh vs Postman

| Aspecto | Script .sh | Postman Collection |
|---------|------------|-------------------|
| **EjecuciÃ³n** | Terminal | UI Visual |
| **Velocidad** | RÃ¡pido (34 tests en 30s) | Similar |
| **Interactivo** | Modo pausas | Click & explore |
| **Modificar queries** | Editar .sh | Click & edit |
| **Tests** | grep en bash | JavaScript assertions |
| **CI/CD** | âœ… Perfecto | âœ… Newman CLI |
| **Aprendizaje** | Para devs avanzados | Para todos |
| **DocumentaciÃ³n** | Comentarios | UI + descripciones |

**RecomendaciÃ³n:** Usa **AMBOS**
- `.sh` â†’ ValidaciÃ³n rÃ¡pida, CI/CD, clase demo
- Postman â†’ ExploraciÃ³n, prÃ¡ctica, debugging

---

## ğŸ¯ PRÃ“XIMOS PASOS

### Para continuar el curso:

1. **Ejecuta todos los tests** para validar Chapter 01
2. **Experimenta** modificando queries
3. **Guarda la collection** para referencia futura
4. **Espera Chapter 02** (usarÃ¡ el mismo environment)

### Para profundizar:

1. **Modifica requests** para aprender
2. **Crea nuevos requests** basados en el schema
3. **Combina queries** de diferentes secciones
4. **Exporta responses** como ejemplos

---

## ğŸ“š RECURSOS ADICIONALES

### GraphQL en Postman:
- [Postman GraphQL Docs](https://learning.postman.com/docs/sending-requests/graphql/graphql-overview/)
- [GraphQL Variables](https://learning.postman.com/docs/sending-requests/graphql/graphql-variables/)

### Collection Runner:
- [Running Collections](https://learning.postman.com/docs/collections/running-collections/intro-to-collection-runs/)
- [Writing Tests](https://learning.postman.com/docs/writing-scripts/test-scripts/)

### Newman CLI:
- [Newman Documentation](https://learning.postman.com/docs/collections/using-newman-cli/command-line-integration-with-newman/)

---

## âœ¨ FEATURES PRÃ“XIMAS (Chapters 2-8)

Cada chapter tendrÃ¡ su propia collection que usarÃ¡ **el mismo environment**:

```
Collections (una por chapter):
â”œâ”€â”€ CHAPTER_01.postman_collection.json âœ…
â”œâ”€â”€ CHAPTER_02.postman_collection.json (prÃ³ximamente)
â”œâ”€â”€ CHAPTER_03.postman_collection.json (prÃ³ximamente)
â””â”€â”€ ...

Environment (uno para TODOS):
â””â”€â”€ GraphQL-NeoBank-Course.postman_environment.json âœ…
```

**Solo necesitas:**
1. Importar la nueva collection
2. Cambiar de proyecto con `mvn spring-boot:run`
3. Â¡El environment sigue funcionando!

---

**Â¡Disfruta explorando GraphQL con Postman!** ğŸš€ğŸ”¥