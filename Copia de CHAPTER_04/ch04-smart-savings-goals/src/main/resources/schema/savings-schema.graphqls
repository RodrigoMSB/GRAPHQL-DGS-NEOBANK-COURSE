# ==============================================================================
# CAPÃTULO 1: INVESTMENT PORTFOLIO TRACKER - SCHEMA GRAPHQL
# ==============================================================================
#
# ğŸ¯ PROPÃ“SITO DE ESTE ARCHIVO:
# Este archivo es el CONTRATO de tu API GraphQL. Define:
# - QUÃ‰ datos existen (Types)
# - QUÃ‰ valores estÃ¡n permitidos (Enums)
# - QUÃ‰ puede enviar el cliente (Inputs)
# - QUÃ‰ puede LEER el cliente (Queries)
# - QUÃ‰ puede MODIFICAR el cliente (Mutations)
#
# ğŸ“š SECCIONES DEL CAPÃTULO QUE CUBRE:
# 1.1 - ComparaciÃ³n REST vs GraphQL
# 1.2 - Componentes base: Schema, Types, Queries, Mutations, Resolvers
# 1.3 - Consultas anidadas y variables
# 1.4 - Filtros, orden y paginaciÃ³n
# 1.5 - Tipado, nullabilidad y seguridad
#
# ==============================================================================
# MAPEO COMPLETO: SCHEMA GRAPHQL â†” CLASES JAVA
# ==============================================================================
#
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚  SCHEMA GRAPHQL              â”‚  IMPLEMENTACIÃ“N JAVA                       â”‚
# â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
# â”‚  enum AssetType              â”‚  AssetType.java (enum)                     â”‚
# â”‚  enum AssetSortField         â”‚  String en AssetQueryResolver              â”‚
# â”‚  enum SortDirection          â”‚  String en AssetQueryResolver              â”‚
# â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
# â”‚  type Portfolio              â”‚  Portfolio.java (model)                    â”‚
# â”‚  type Asset                  â”‚  Asset.java (model)                        â”‚
# â”‚  type Performance            â”‚  Performance.java (model)                  â”‚
# â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
# â”‚  type AssetConnection        â”‚  AssetQueryResolver.AssetConnection (DTO)  â”‚
# â”‚  type AssetEdge              â”‚  AssetQueryResolver.AssetEdge (DTO)        â”‚
# â”‚  type PageInfo               â”‚  AssetQueryResolver.PageInfo (DTO)         â”‚
# â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
# â”‚  type MutationResponse       â”‚  PortfolioMutationResolver.MutationResponseâ”‚
# â”‚  type CreatePortfolioResponseâ”‚  PortfolioMutationResolver.CreatePortfolio â”‚
# â”‚  type AddAssetResponse       â”‚  PortfolioMutationResolver.AddAssetResponseâ”‚
# â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
# â”‚  input AssetFilterInput      â”‚  Map<String, Object> en AssetQueryResolver â”‚
# â”‚  input AssetSortInput        â”‚  Map<String, Object> en AssetQueryResolver â”‚
# â”‚  input PaginationInput       â”‚  Map<String, Object> en AssetQueryResolver â”‚
# â”‚  input CreatePortfolioInput  â”‚  Map<String, Object> en MutationResolver   â”‚
# â”‚  input AddAssetInput         â”‚  Map<String, Object> en MutationResolver   â”‚
# â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
# â”‚  Query.myPortfolios          â”‚  PortfolioQueryResolver.myPortfolios()     â”‚
# â”‚  Query.portfolio             â”‚  PortfolioQueryResolver.portfolio()        â”‚
# â”‚  Query.portfolioPerformance  â”‚  PortfolioQueryResolver.portfolioPerform() â”‚
# â”‚  Query.searchAsset           â”‚  PortfolioQueryResolver.searchAsset()      â”‚
# â”‚  Query.assets                â”‚  AssetQueryResolver.assets()               â”‚
# â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
# â”‚  Mutation.createPortfolio    â”‚  PortfolioMutationResolver.createPortfolio â”‚
# â”‚  Mutation.addAsset           â”‚  PortfolioMutationResolver.addAsset()      â”‚
# â”‚  Mutation.removeAsset        â”‚  PortfolioMutationResolver.removeAsset()   â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
#
# ==============================================================================


# ==============================================================================
# 1. ENUMS - Valores Permitidos
# ==============================================================================

"""
Tipos de activos financieros soportados.

ğŸ“ SecciÃ³n 1.2: Demuestra el uso de Enums en GraphQL
ğŸ“ SecciÃ³n 1.5: ValidaciÃ³n automÃ¡tica - solo acepta estos valores

IMPLEMENTACIÃ“N JAVA: AssetType.java
```java
public enum AssetType {
    STOCK,      // Acciones
    CRYPTO,     // Criptomonedas
    ETF,        // Fondos cotizados
    BOND,       // Bonos
    COMMODITY   // Materias primas
}
```

ğŸ’¡ EJEMPLO DE USO EN QUERY:
```graphql
query {
  assets(portfolioId: "001", filter: { assetType: STOCK }) {
    edges { node { symbol } }
  }
}
```
"""
enum AssetType {
  "Acciones de empresas (Apple, Google, etc.)"
  STOCK
  
  "Criptomonedas (Bitcoin, Ethereum, etc.)"
  CRYPTO
  
  "Fondos cotizados - Exchange Traded Funds"
  ETF
  
  "Bonos gubernamentales o corporativos"
  BOND
  
  "Materias primas (oro, plata, petrÃ³leo)"
  COMMODITY
}

"""
Campos disponibles para ordenar activos.

ğŸ“ SecciÃ³n 1.4: Se usa junto con SortDirection para ordenar resultados.

IMPLEMENTACIÃ“N JAVA: AssetQueryResolver.applySorting()
```java
switch (field) {
    case "SYMBOL":
        comparator = Comparator.comparing(Asset::getSymbol);
        break;
    case "TOTAL_VALUE":
        comparator = Comparator.comparing(Asset::getTotalValue);
        break;
    case "PROFIT_LOSS_PERCENT":
        comparator = Comparator.comparing(Asset::getProfitLossPercent);
        break;
    case "QUANTITY":
        comparator = Comparator.comparing(Asset::getQuantity);
        break;
}
```
"""
enum AssetSortField {
  "Ordenar por sÃ­mbolo (alfabÃ©tico)"
  SYMBOL
  
  "Ordenar por valor total"
  TOTAL_VALUE
  
  "Ordenar por ganancia/pÃ©rdida porcentual"
  PROFIT_LOSS_PERCENT
  
  "Ordenar por cantidad de unidades"
  QUANTITY
}

"""
DirecciÃ³n del ordenamiento.

IMPLEMENTACIÃ“N JAVA: AssetQueryResolver.applySorting()
```java
if ("DESC".equals(direction)) {
    comparator = comparator.reversed();
}
```
"""
enum SortDirection {
  "Ascendente (A-Z, 0-9, menor a mayor)"
  ASC
  
  "Descendente (Z-A, 9-0, mayor a menor)"
  DESC
}


# ==============================================================================
# 2. TYPES - Estructura de Datos (lo que RETORNA el servidor)
# ==============================================================================

"""
Representa un portfolio de inversiÃ³n de un cliente.

ğŸ“ SecciÃ³n 1.2: Define la estructura de datos principal
ğŸ“ SecciÃ³n 1.3: Permite consultas anidadas (assets, performance)

IMPLEMENTACIÃ“N JAVA: Portfolio.java
```java
public class Portfolio {
    private String id;
    private String name;
    private String ownerId;
    private String ownerName;
    private Double totalValue;
    private LocalDateTime createdAt;
    private List<Asset> assets;      // RelaciÃ³n anidada
    private Performance performance; // RelaciÃ³n anidada
}
```

RESOLVER: PortfolioQueryResolver.java
```java
@QueryMapping
public Portfolio portfolio(@Argument String id) {
    return dataService.getPortfolioById(id);
}
```

ğŸ’¡ EJEMPLO DE CONSULTA ANIDADA:
```graphql
query {
  portfolio(id: "portfolio-001") {
    name
    totalValue
    assets {        â† Spring GraphQL llama portfolio.getAssets()
      symbol
      currentPrice
    }
    performance {   â† Spring GraphQL llama portfolio.getPerformance()
      totalReturn
    }
  }
}
```
"""
type Portfolio {
  "ID Ãºnico del portfolio - NUNCA es null"
  id: ID!
  
  "Nombre descriptivo del portfolio (ej: 'Retirement Fund')"
  name: String!
  
  "ID del usuario propietario"
  ownerId: String!
  
  "Nombre del usuario propietario"
  ownerName: String!
  
  "Valor total actual del portfolio en USD"
  totalValue: Float!
  
  "Fecha y hora de creaciÃ³n (formato ISO 8601)"
  createdAt: String!
  
  """
  Lista de activos en el portfolio.
  JAVA: portfolio.getAssets() retorna List<Asset>
  """
  assets: [Asset!]!
  
  """
  Rendimiento histÃ³rico del portfolio.
  JAVA: portfolio.getPerformance() puede retornar null
  """
  performance: Performance
}

"""
Representa un activo financiero dentro de un portfolio.

IMPLEMENTACIÃ“N JAVA: Asset.java
```java
public class Asset {
    private String id;
    private String symbol;
    private String name;
    private AssetType assetType;
    private Double quantity;
    private Double averageBuyPrice;
    private Double currentPrice;
    private LocalDateTime lastUpdated;
    
    // CAMPOS CALCULADOS (no estÃ¡n en BD):
    public Double getTotalValue() {
        return quantity * currentPrice;
    }
    
    public Double getProfitLossPercent() {
        return ((currentPrice - averageBuyPrice) / averageBuyPrice) * 100;
    }
}
```

MAPEO CAMPO POR CAMPO:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Campo GraphQL       â”‚ Getter Java                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id                  â”‚ asset.getId()                       â”‚
â”‚ symbol              â”‚ asset.getSymbol()                   â”‚
â”‚ name                â”‚ asset.getName()                     â”‚
â”‚ assetType           â”‚ asset.getAssetType()                â”‚
â”‚ quantity            â”‚ asset.getQuantity()                 â”‚
â”‚ averageBuyPrice     â”‚ asset.getAverageBuyPrice()          â”‚
â”‚ currentPrice        â”‚ asset.getCurrentPrice()             â”‚
â”‚ totalValue          â”‚ asset.getTotalValue() [CALCULADO]   â”‚
â”‚ profitLossPercent   â”‚ asset.getProfitLossPercent() [CALC] â”‚
â”‚ lastUpdated         â”‚ asset.getLastUpdated().toString()   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
"""
type Asset {
  id: ID!
  symbol: String!
  name: String!
  assetType: AssetType!
  quantity: Float!
  averageBuyPrice: Float!
  currentPrice: Float!
  
  """
  Valor total = quantity Ã— currentPrice
  JAVA: getTotalValue() es un mÃ©todo CALCULADO
  """
  totalValue: Float!
  
  """
  Ganancia o pÃ©rdida en porcentaje.
  JAVA: getProfitLossPercent() es un mÃ©todo CALCULADO
  """
  profitLossPercent: Float!
  
  lastUpdated: String!
}

"""
Representa el rendimiento histÃ³rico de un portfolio.

IMPLEMENTACIÃ“N JAVA: Performance.java
```java
public class Performance {
    private Double totalReturn;
    private Double yearReturn;
    private Double monthReturn;
    private Double weekReturn;
    private Asset bestPerformer;   // RelaciÃ³n anidada
    private Asset worstPerformer;  // RelaciÃ³n anidada
}
```
"""
type Performance {
  totalReturn: Float!
  yearReturn: Float!
  monthReturn: Float!
  weekReturn: Float!
  bestPerformer: Asset
  worstPerformer: Asset
}


# ==============================================================================
# 2.2 TYPES DE PAGINACIÃ“N (PatrÃ³n Relay/Connection)
# ==============================================================================

"""
Respuesta paginada de activos (PatrÃ³n Relay Connection).

ğŸ“ SecciÃ³n 1.4: Estructura estÃ¡ndar para paginaciÃ³n

IMPLEMENTACIÃ“N JAVA: AssetQueryResolver.AssetConnection
```java
public static class AssetConnection {
    private List<AssetEdge> edges;
    private PageInfo pageInfo;
    private Integer totalCount;
}
```

RESOLVER: AssetQueryResolver.applyPagination()
```java
private AssetConnection applyPagination(List<Asset> assets, Map<String, Object> pagination) {
    // 1. Encontrar Ã­ndice de inicio desde cursor
    // 2. Calcular sublista segÃºn limit
    // 3. Crear edges con cursors
    // 4. Crear pageInfo con metadatos
    return new AssetConnection(edges, pageInfo, assets.size());
}
```
"""
type AssetConnection {
  edges: [AssetEdge!]!
  pageInfo: PageInfo!
  totalCount: Int
}

"""
Envuelve un Asset con su cursor de paginaciÃ³n.

IMPLEMENTACIÃ“N JAVA: AssetQueryResolver.AssetEdge
```java
public static class AssetEdge {
    private Asset node;
    private String cursor; // Base64 del ID
}
```
"""
type AssetEdge {
  node: Asset!
  
  """
  Cursor Ãºnico para este elemento.
  JAVA: Base64.getEncoder().encodeToString(id.getBytes())
  """
  cursor: String!
}

"""
Metadatos de paginaciÃ³n.

IMPLEMENTACIÃ“N JAVA: AssetQueryResolver.PageInfo
```java
public static class PageInfo {
    private Boolean hasNextPage;
    private Boolean hasPreviousPage;
    private String startCursor;
    private String endCursor;
}
```
"""
type PageInfo {
  hasNextPage: Boolean!
  hasPreviousPage: Boolean!
  startCursor: String
  endCursor: String
}


# ==============================================================================
# 2.3 TYPES DE RESPUESTA (Para Mutations)
# ==============================================================================

"""
Respuesta genÃ©rica para mutations.

IMPLEMENTACIÃ“N JAVA: PortfolioMutationResolver.MutationResponse
```java
public static class MutationResponse {
    private Boolean success;
    private String message;
    private String code;
    
    public static Builder builder() { return new Builder(); }
}
```
"""
type MutationResponse {
  success: Boolean!
  message: String!
  code: String
}

"""
Respuesta para createPortfolio mutation.

IMPLEMENTACIÃ“N JAVA: PortfolioMutationResolver.CreatePortfolioResponse
```java
public static class CreatePortfolioResponse {
    private Boolean success;
    private String message;
    private Portfolio portfolio;
}
```
"""
type CreatePortfolioResponse {
  success: Boolean!
  message: String!
  portfolio: Portfolio
}

"""
Respuesta para addAsset mutation.

IMPLEMENTACIÃ“N JAVA: PortfolioMutationResolver.AddAssetResponse
```java
public static class AddAssetResponse {
    private Boolean success;
    private String message;
    private Asset asset;
}
```
"""
type AddAssetResponse {
  success: Boolean!
  message: String!
  asset: Asset
}


# ==============================================================================
# 3. INPUTS - Datos que ENVÃA el cliente
# ==============================================================================

"""
Filtros para buscar activos.

ğŸ“ SecciÃ³n 1.4: Todos los campos son opcionales y acumulativos (AND)

IMPLEMENTACIÃ“N JAVA: AssetQueryResolver.applyFilters()
```java
private List<Asset> applyFilters(List<Asset> assets, Map<String, Object> filter) {
    return assets.stream()
        .filter(asset -> {
            if (filter.containsKey("assetType")) {
                AssetType filterType = AssetType.valueOf((String) filter.get("assetType"));
                if (!asset.getAssetType().equals(filterType)) return false;
            }
            if (filter.containsKey("minValue")) {
                Double minValue = ((Number) filter.get("minValue")).doubleValue();
                if (asset.getTotalValue() < minValue) return false;
            }
            // ... mÃ¡s filtros
            return true;
        })
        .collect(Collectors.toList());
}
```
"""
input AssetFilterInput {
  assetType: AssetType
  minValue: Float
  maxValue: Float
  symbolContains: String
}

"""
Ordenamiento de activos.

IMPLEMENTACIÃ“N JAVA: AssetQueryResolver.applySorting()
```java
private List<Asset> applySorting(List<Asset> assets, Map<String, Object> sort) {
    String field = (String) sort.get("field");
    String direction = (String) sort.get("direction");
    
    Comparator<Asset> comparator = switch (field) {
        case "SYMBOL" -> Comparator.comparing(Asset::getSymbol);
        case "TOTAL_VALUE" -> Comparator.comparing(Asset::getTotalValue);
        // ...
    };
    
    if ("DESC".equals(direction)) {
        comparator = comparator.reversed();
    }
    
    return assets.stream().sorted(comparator).toList();
}
```
"""
input AssetSortInput {
  field: AssetSortField!
  direction: SortDirection!
}

"""
ParÃ¡metros de paginaciÃ³n cursor-based.

IMPLEMENTACIÃ“N JAVA: AssetQueryResolver.applyPagination()
```java
int limit = 10;  // Default
String afterCursor = null;

if (pagination != null) {
    if (pagination.containsKey("limit")) {
        limit = ((Number) pagination.get("limit")).intValue();
    }
    if (pagination.containsKey("after")) {
        afterCursor = (String) pagination.get("after");
    }
}
```
"""
input PaginationInput {
  limit: Int
  after: String
  before: String
}

"""
Input para crear un portfolio.

IMPLEMENTACIÃ“N JAVA: PortfolioMutationResolver.createPortfolio()
```java
@MutationMapping
public CreatePortfolioResponse createPortfolio(@Argument Map<String, Object> input) {
    String name = (String) input.get("name");
    Portfolio portfolio = dataService.createPortfolio(name, userId, userName);
    return CreatePortfolioResponse.builder()
        .success(true)
        .message("Portfolio created successfully")
        .portfolio(portfolio)
        .build();
}
```
"""
input CreatePortfolioInput {
  name: String!
}

"""
Input para aÃ±adir un activo a un portfolio.

IMPLEMENTACIÃ“N JAVA: PortfolioMutationResolver.addAsset()
```java
@MutationMapping
public AddAssetResponse addAsset(@Argument Map<String, Object> input) {
    String portfolioId = (String) input.get("portfolioId");
    String symbol = (String) input.get("symbol");
    AssetType assetType = AssetType.valueOf((String) input.get("assetType"));
    Double quantity = ((Number) input.get("quantity")).doubleValue();
    Double buyPrice = ((Number) input.get("buyPrice")).doubleValue();
    
    Asset asset = dataService.addAssetToPortfolio(
        portfolioId, symbol, assetName, assetType, quantity, buyPrice
    );
    
    return AddAssetResponse.builder()
        .success(true)
        .asset(asset)
        .build();
}
```
"""
input AddAssetInput {
  portfolioId: ID!
  symbol: String!
  assetType: AssetType!
  quantity: Float!
  buyPrice: Float!
}


# ==============================================================================
# 4. QUERIES - Operaciones de LECTURA
# ==============================================================================

type Query {
  
  """
  Obtiene todos los portfolios del usuario autenticado.
  
  IMPLEMENTACIÃ“N JAVA: PortfolioQueryResolver.myPortfolios()
```java
  @QueryMapping
  public List<Portfolio> myPortfolios() {
      String userId = "user-001"; // En producciÃ³n: del SecurityContext
      return dataService.getPortfoliosByOwnerId(userId);
  }
```
  """
  myPortfolios: [Portfolio!]!
  
  """
  Obtiene un portfolio especÃ­fico por su ID.
  
  IMPLEMENTACIÃ“N JAVA: PortfolioQueryResolver.portfolio()
```java
  @QueryMapping
  public Portfolio portfolio(@Argument String id) {
      return dataService.getPortfolioById(id);
  }
```
  
  ğŸ’¡ EJEMPLO:
```graphql
  query GetPortfolio($id: ID!) {
    portfolio(id: $id) {
      name
      assets { symbol }
    }
  }
  # Variables: { "id": "portfolio-001" }
```
  """
  portfolio(id: ID!): Portfolio
  
  """
  Obtiene el rendimiento de un portfolio.
  
  IMPLEMENTACIÃ“N JAVA: PortfolioQueryResolver.portfolioPerformance()
```java
  @QueryMapping
  public Performance portfolioPerformance(@Argument String portfolioId) {
      return dataService.getPerformance(portfolioId);
  }
```
  """
  portfolioPerformance(portfolioId: ID!): Performance
  
  """
  Obtiene activos con filtros, orden y paginaciÃ³n.
  
  ğŸ“ SecciÃ³n 1.4: Query mÃ¡s compleja del capÃ­tulo
  
  IMPLEMENTACIÃ“N JAVA: AssetQueryResolver.assets()
```java
  @QueryMapping
  public AssetConnection assets(
          @Argument String portfolioId,
          @Argument Map<String, Object> filter,
          @Argument Map<String, Object> sort,
          @Argument Map<String, Object> pagination) {
      
      List<Asset> allAssets = dataService.getAssetsByPortfolioId(portfolioId);
      List<Asset> filteredAssets = applyFilters(allAssets, filter);
      List<Asset> sortedAssets = applySorting(filteredAssets, sort);
      
      return applyPagination(sortedAssets, pagination);
  }
```
  
  ğŸ’¡ EJEMPLO COMPLETO:
```graphql
  query {
    assets(
      portfolioId: "portfolio-001"
      filter: { assetType: STOCK, minValue: 1000 }
      sort: { field: TOTAL_VALUE, direction: DESC }
      pagination: { limit: 5 }
    ) {
      totalCount
      edges {
        cursor
        node { symbol totalValue }
      }
      pageInfo { hasNextPage endCursor }
    }
  }
```
  """
  assets(
    portfolioId: ID!
    filter: AssetFilterInput
    sort: AssetSortInput
    pagination: PaginationInput
  ): AssetConnection!
  
  """
  Busca un activo por su sÃ­mbolo.
  
  IMPLEMENTACIÃ“N JAVA: PortfolioQueryResolver.searchAsset()
```java
  @QueryMapping
  public Asset searchAsset(@Argument String symbol) {
      return dataService.getAssetBySymbol(symbol);
  }
```
  """
  searchAsset(symbol: String!): Asset
}


# ==============================================================================
# 5. MUTATIONS - Operaciones de ESCRITURA
# ==============================================================================

type Mutation {
  
  """
  Crea un nuevo portfolio.
  
  IMPLEMENTACIÃ“N JAVA: PortfolioMutationResolver.createPortfolio()
```java
  @MutationMapping
  public CreatePortfolioResponse createPortfolio(@Argument Map<String, Object> input) {
      String name = (String) input.get("name");
      Portfolio portfolio = dataService.createPortfolio(name, userId, userName);
      
      return CreatePortfolioResponse.builder()
          .success(true)
          .message("Portfolio created successfully")
          .portfolio(portfolio)
          .build();
  }
```
  
  ğŸ’¡ EJEMPLO:
```graphql
  mutation {
    createPortfolio(input: { name: "Growth Portfolio 2024" }) {
      success
      portfolio { id name }
    }
  }
```
  """
  createPortfolio(input: CreatePortfolioInput!): CreatePortfolioResponse!
  
  """
  AÃ±ade un activo a un portfolio.
  
  IMPLEMENTACIÃ“N JAVA: PortfolioMutationResolver.addAsset()
```java
  @MutationMapping
  public AddAssetResponse addAsset(@Argument Map<String, Object> input) {
      // Extraer datos del input Map
      Asset asset = dataService.addAssetToPortfolio(...);
      
      return AddAssetResponse.builder()
          .success(true)
          .asset(asset)
          .build();
  }
```
  """
  addAsset(input: AddAssetInput!): AddAssetResponse!
  
  """
  Elimina un activo de un portfolio.
  
  IMPLEMENTACIÃ“N JAVA: PortfolioMutationResolver.removeAsset()
```java
  @MutationMapping
  public MutationResponse removeAsset(
          @Argument String portfolioId,
          @Argument String assetId) {
      
      boolean removed = dataService.removeAsset(portfolioId, assetId);
      
      return MutationResponse.builder()
          .success(removed)
          .message(removed ? "Asset removed" : "Asset not found")
          .code(removed ? "ASSET_REMOVED" : "ASSET_NOT_FOUND")
          .build();
  }
```
  """
  removeAsset(portfolioId: ID!, assetId: ID!): MutationResponse!
}


# ==============================================================================
# RESUMEN: ARCHIVOS JAVA INVOLUCRADOS
# ==============================================================================
#
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚  ARCHIVO                            â”‚  PROPÃ“SITO                           â”‚
# â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
# â”‚  model/Portfolio.java               â”‚  Entidad Portfolio                   â”‚
# â”‚  model/Asset.java                   â”‚  Entidad Asset + campos calculados   â”‚
# â”‚  model/Performance.java             â”‚  Entidad Performance                 â”‚
# â”‚  model/AssetType.java               â”‚  Enum de tipos de activo             â”‚
# â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
# â”‚  graphql/PortfolioQueryResolver.javaâ”‚  Queries: myPortfolios, portfolio,   â”‚
# â”‚                                     â”‚  searchAsset, portfolioPerformance   â”‚
# â”‚  graphql/AssetQueryResolver.java    â”‚  Query: assets (con paginaciÃ³n)      â”‚
# â”‚                                     â”‚  + DTOs: AssetConnection, AssetEdge  â”‚
# â”‚  graphql/PortfolioMutationResolver  â”‚  Mutations: createPortfolio,         â”‚
# â”‚                                     â”‚  addAsset, removeAsset + Response DTOsâ”‚
# â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
# â”‚  data/MockDataService.java          â”‚  Servicio de datos (in-memory)       â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
#
# ==============================================================================